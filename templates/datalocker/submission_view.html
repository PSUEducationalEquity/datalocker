{# Copyright 2015 The Pennsylvania State University. Office of the Vice Provost for Educational Equity. All Rights Reserved. #}
{% extends "datalocker/app_template.html" %}
{% load staticfiles %}
{% load datalocker_tags %}

{% block breadcrumb-trail %}
  <li>
    <a href="{% url 'datalocker:index' %}">
      <span class="sr-only">List of </span>My Lockers
    </a>
  </li>
  <li>
    <a href="{% url 'datalocker:submissions_list' submission.locker.id %}">
      All Submissions<span class="sr-only"> for {{ locker.name }}</span>
    </a>
  </li>
  <li class="active">
    <span class="sr-only">{{ locker.name }}</span> Submission
  </li>
{% endblock breadcrumb-trail %}

{% block page-meta-title %}Submission View{% endblock page-meta-title %}

{% block site-styles %}
  {{ block.super }}
  <link type="text/css" rel="stylesheet"
        href="{% static 'datalocker/css/user_colors.css' %}" />
{% endblock site-styles %}

{% block content %}
  <div class="container-fluid">
    <h1>{{ submission.locker.name }}</h1>

    <ul class="messages list-unstyled" id="user-messages">
        {% for msg in messages %}
          <li class="alert {{ msg.tags }}">{{ msg|safe }}</li>
        {% endfor %}
    </ul>

    <div class="row">
      <div class="col-md-{% if sidebar_enabled %}7{% else %}12{% endif %}">
        <div class="pagination" aria-label="submission navigation buttons">
          {% include "datalocker/pagination_template.html" %}
        </div>

        <ul class="list-unstyled">
          <li class="key-value-pair">
            <div class="key">Submission Date</div>
            <div class="value">{{ submission.timestamp }}</div>
          </li>
          {% for key, value in submission.data_dict.items %}
            <li class="key-value-pair">
              <div class="key">{{ key }}</div>
              <div class="value">{{ value }}</div>
            </li>
          {% endfor %}
        </ul>

        <div class="pagination" aria-label="submission navigation buttons">
          {% include "datalocker/pagination_template.html" %}
        </div>
      </div>


      {% if sidebar_enabled %}
        <div class="col-md-5">
          {% if workflow_enabled %}
            <div class="panel panel-default panel-workflow">
              <div class="panel-heading">
                <div class="panel-title">Workflow</div>
              </div>
              <div class="panel-body">
                <div>
                  <div class="workflow-label">Current State:</div>
                  <div class="workflow-state js-workflow-current-state">{{ workflow_state }}</div>
                </div>
                {% if workflow_users_can_edit %}
                  <form action="{% url 'datalocker:workflow_states' submission.locker.id submission.id %}"
                        id="workflow_form" method="POST">
                    {% csrf_token %}

                    <label for="workflow-state">Change the workflow state</label>
                    <select name="workflow-state"
                            id="workflow-state"
                            class="form-control">
                      <option selected="selected"
                              disabled="disabled"
                              value="0"
                              >Select a new workflow state</option>
                      {% for state in workflow_states %}
                        <option value="{{ state }}">{{ state }}</option>
                      {% endfor %}
                    </select>
                  </form>
                {% endif %}
              </div>
            </div>
          {% endif %}

          {% if discussion_enabled %}
            {% if discussion_users_have_access %}
              <div class="panel panel-default panel-discussion"
                   data-url="{% url 'datalocker:comments_list' submission.locker.id submission.pk %}">
                <div class="panel-heading" >
                  <div class="panel-title">Discussion</div>
                </div>
                <div class="panel-body">
                  <form method="post"
                        action="{% url 'datalocker:comment_add' submission.locker.id submission.pk %}">
                    {% csrf_token %}

                    <textarea name="comment"
                              class="comment-textarea"
                              id="comment-text"
                              placeholder="Say something about this submission"
                              ></textarea>
                    <button type="button"
                            class="btn btn-primary btn-xs comment-button"
                            id="comment-add"
                            role="add-comment"
                            >Add</button>
                  </form>

                  <ul class="media-list discussion-tree">
                    <li class="media">
                      <div class="media-left">
                        <span class="media-object user-icon user-color-azure">PR</span>
                      </div>
                      <div class="media-body">
                        <h4 class="media-heading">Paul Rentschler</h4>
                        <p class="discussion-timestamp text-muted">10 minutes ago</p>
                        <p class="discussion-comment">
                          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam sodales rutrum viverra. Donec pharetra, urna at viverra ultrices, orci sapien consequat augue, sit amet lacinia mauris ex eget sapien. Morbi elementum aliquet dictum. Etiam tincidunt ultrices tempus. Quisque porta dui et egestas viverra. Nulla ultricies magna vitae urna tincidunt elementum. Aliquam sit amet eros et neque ultricies gravida. Fusce at hendrerit elit. Aliquam pretium volutpat mattis. Suspendisse euismod odio non odio porta consequat. Suspendisse potenti.
                        </p>
                        <div class="discussion-actions">
                          <a href="#" role="discussion-reply">Reply</a>
                          &#149;
                          <a href="#" role="discussion-edit">Edit</a>
                        </div>
                      </div>
                      <ul class="discussion-replies"></ul>
                    </li>
                    <li class="media">
                      <div class="media-left">
                        <span class="media-object user-icon user-color-azure">PR</span>
                      </div>
                      <div class="media-body">
                        <h4 class="media-heading">Paul Rentschler</h4>
                        <p class="discussion-timestamp text-muted">22 minutes ago</p>
                        <p class="discussion-comment">
                          Donec neque erat, malesuada eget tempor eget, accumsan ac mauris. Vestibulum ut ligula odio. Proin vitae tellus eu tellus pharetra dictum ac vel tortor. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi posuere ante id justo interdum viverra. Proin accumsan tristique magna. Vivamus finibus lacus orci, sit amet convallis libero pharetra id. Aliquam in massa in urna ornare luctus. Etiam ac neque aliquam, facilisis orci a, placerat elit. Aenean urna dui, mattis at faucibus eget, vulputate ut nibh. Integer dapibus laoreet ultricies. Quisque a nunc justo. Maecenas non leo eget mauris hendrerit accumsan.
                        </p>
                        <div class="discussion-actions">
                          <a href="#" role="discussion-reply">Reply</a>
                          &#149;
                          <a href="#" role="discussion-edit">Edit</a>
                        </div>
                      </div>
                      <ul class="discussion-replies">
                        <li class="media">
                          <div class="media-left">
                            <span class="media-object user-icon user-color-hard-cyan">SA</span>
                          </div>
                          <div class="media-body">
                            <h4 class="media-heading">Shelly Aina</h4>
                            <p class="discussion-timestamp text-muted">20 minutes ago</p>
                            <p class="discussion-comment">
                              Nunc sit amet velit quis tortor ornare lacinia non et velit. Curabitur feugiat egestas lorem, vitae accumsan leo mattis vitae. Donec non dui a metus consectetur tempus sit amet at magna. Vivamus turpis ipsum, luctus eu laoreet ac, rhoncus et felis. Fusce eget efficitur libero. Mauris vel pellentesque nibh. Phasellus elementum risus ex. Nam at ultrices ipsum. Proin pharetra ante et nibh consectetur egestas.
                            </p>
                            <div class="discussion-actions">
                              <a href="#" role="discussion-reply">Reply</a>
                            </div>
                          </div>
                        </li>
                        <li class="media">
                          <div class="media-left">
                            <span class="media-object user-icon user-color-midnight-blue">MB</span>
                          </div>
                          <div class="media-body">
                            <h4 class="media-heading">Michael Brahosky</h4>
                            <p class="discussion-timestamp text-muted">21 minutes ago</p>
                            <p class="discussion-comment">
                              Phasellus congue maximus ultricies. Cras porttitor felis eu commodo mollis. Ut enim lacus, vehicula vitae ultricies at, elementum vitae nulla. Curabitur vitae felis tempus, luctus ex vel, interdum nulla. In eget pellentesque lectus, in pellentesque arcu. Vivamus quis finibus mauris, eu laoreet mi. Vestibulum sodales libero eu quam ullamcorper, nec euismod tortor tempus. Pellentesque ut leo eleifend, rutrum odio in, feugiat enim. Vivamus sit amet imperdiet nibh. Curabitur sagittis vel elit id imperdiet.
                            </p>
                            <div class="discussion-actions">
                              <a href="#" role="discussion-reply">Reply</a>
                            </div>
                          </div>
                        </li>
                      </ul>
                    </li>
                    <li class="media">
                      <div class="media-left">
                        <span class="media-object user-icon user-color-midnight-blue">MB</span>
                      </div>
                      <div class="media-body">
                        <h4 class="media-heading">Michael Brahosky</h4>
                        <p class="discussion-timestamp text-muted">4 hours ago</p>
                        <p class="discussion-comment">
                          Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec nunc nibh, tempus id massa eget, ullamcorper efficitur nulla. Fusce tellus neque, tincidunt sit amet condimentum et, pretium in ligula. Vivamus tincidunt a tellus ut porttitor. Phasellus congue aliquam placerat. Suspendisse scelerisque felis non dapibus semper. Nullam vulputate, nunc vitae hendrerit tempus, purus risus laoreet nisi, eu consectetur lorem orci sit amet purus. Duis ullamcorper metus porttitor erat pulvinar molestie. Maecenas eget rutrum felis, et congue turpis. Quisque bibendum nisi vel gravida imperdiet. Ut a interdum augue. Fusce dignissim magna id efficitur interdum. Duis pulvinar laoreet elit, nec laoreet neque tempus facilisis.
                        </p>
                        <div class="discussion-actions">
                          <a href="#" role="discussion-reply">Reply</a>
                        </div>
                      </div>
                      <ul class="discussion-replies"></ul>
                    </li>
                    <li class="media">
                      <div class="media-left">
                        <span class="media-object user-icon user-color-hard-cyan">SA</span>
                      </div>
                      <div class="media-body">
                        <h4 class="media-heading">Shelly Aina</h4>
                        <p class="discussion-timestamp text-muted">2 days ago</p>
                        <p class="discussion-comment">
                          Nulla malesuada semper nulla, nec viverra eros gravida ut. Vestibulum ac massa in ante tempus placerat id eget neque. Suspendisse a lorem ac purus pulvinar varius. Aliquam scelerisque nunc vel arcu tristique lobortis mattis vel sapien. Suspendisse potenti. Pellentesque commodo, ligula ut dignissim scelerisque, augue tellus maximus enim, sit amet elementum nibh ligula ut risus. Etiam a diam mi. Nulla facilisi. Vivamus pharetra, augue in pulvinar malesuada, neque est consequat mi, nec laoreet justo lectus non odio. Vivamus et scelerisque nunc. Phasellus sit amet tristique massa. Nam pharetra orci non quam aliquam egestas. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum tempus nisi at libero gravida, non faucibus lacus blandit. Donec lobortis feugiat aliquam. Curabitur id ornare eros, quis consectetur quam.
                        </p>
                        <div class="discussion-actions">
                          <a href="#" role="discussion-reply">Reply</a>
                        </div>
                      </div>
                      <ul class="discussion-replies"></ul>
                    </li>
                    <li class="media">
                      <div class="media-left">
                        <span class="media-object user-icon user-color-azure">PR</span>
                      </div>
                      <div class="media-body">
                        <h4 class="media-heading">Paul Rentschler</h4>
                        <p class="discussion-timestamp text-muted">5 days ago</p>
                        <p class="discussion-comment">
                          Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Proin eu justo dolor. Ut nec lacus nec orci pellentesque egestas. Donec laoreet justo arcu, id pellentesque odio tincidunt nec. Aenean dapibus facilisis nisi, nec faucibus elit gravida eget. Nam blandit ultrices quam, at blandit urna dictum eget. Aliquam aliquet arcu condimentum est fermentum, quis cursus ex pharetra. Fusce pretium turpis condimentum ex elementum iaculis. Phasellus id semper nisl. In urna odio, ornare vel ante sit amet, convallis pulvinar orci. Mauris ex tortor, consequat varius bibendum ut, lobortis at augue. Sed eu lacus luctus, consequat dui ut, vestibulum ligula. Nunc id dui ut metus imperdiet placerat. Praesent vulputate rutrum ornare. Praesent efficitur accumsan tortor a maximus.
                        </p>
                        <div class="discussion-actions">
                          <a href="#" role="discussion-reply">Reply</a>
                        </div>
                      </div>
                      <ul class="discussion-replies"></ul>
                    </li>
                  </ul>
                </div>
              </div>
            {% endif %}
          {% endif %}






{% comment %}

          {% if discussion_enabled %}
            {% if discussion_users_have_access %}
              <div class="panel panel-default panel-comments" id="comments-div"
                   data-url="{% url 'datalocker:comments_list' submission.locker.id submission.pk %}">
                <div class="panel-heading" >
                  <div class="panel-title">Comments</div>
                </div>
                <div class="panel-body">
                  <div class="discussion-controls">
                    <form method="post"
                          action="{% url 'datalocker:comment_add' submission.locker.id submission.pk %}">
                      {% csrf_token %}

                      <textarea name="comment"
                                class="comment-textarea"
                                id="comment-text"
                                placeholder="Say something about this submission"
                                ></textarea>
                      <button type="button"
                              class="btn btn-primary btn-xs comment-button"
                              id="comment-add"
                              role="add-comment"
                              >Add</button>
                    </form>
                  </div>
                  <div class="comment-feed-container">
                    <ul class="media-list" id="comment-list">
                    </ul>
                  </div>
                </div>
              </div>
            {% endif %}
          {% endif %}
{% endcomment %}

        </div>
      {% endif %}
    </div>
  </div>
{% endblock %}


{% block site-scripts %}
  {{ block.super }}
  <script type="text/javascript"
          src=" {% static 'datalocker/js/messages.js' %}"></script>
  <script type="text/javascript"
          src=" {% static 'datalocker/js/workflow.js' %}"></script>
  <script type="text/javascript"
          src="{% static 'datalocker/js/commenting.js' %}"></script>
{% endblock site-scripts %}
